/*!
 * miniTip v1.5.1
 *
 * Updated: June 30, 2012
 * Requires: jQuery v1.3+
 *
 * (c) 2011, James Simpson
 * http://goldfirestudios.com
 *
 * Dual licensed under the MIT and GPL
 *
 * Documentation found at:
 * http://goldfirestudios.com/blog/81/miniTip-jQuery-Plugin
*/
(function(d){d.fn.miniTip=function(p){var a=d.extend({title:"",content:!1,delay:300,anchor:"n",event:"hover",fadeIn:200,fadeOut:200,aHide:!0,maxW:"250px",offset:5,doHide:!1,className:".miniTip"},p);d("#miniTip")[0]||d("body").append('<div id="miniTip" class="'+a.className+'"><div id="miniTip_t"></div><div id="miniTip_c"></div><div id="miniTip_a"></div></div>');var b=d("#miniTip"),v=d("#miniTip_t"),x=d("#miniTip_c"),w=d("#miniTip_a");return a.doHide?(b.stop(!0,!0).fadeOut(a.fadeOut),!1):this.each(function(){var e= d(this),t=a.content?a.content:e.attr("title");if(""!=t&&"undefined"!=typeof t){var q=window.delay=!1,r=!0;a.content||e.removeAttr("title");"hover"==a.event?(e.hover(function(){b.removeAttr("click");r=!0;u.call(this)},function(){r=!1;m()}),a.aHide||b.hover(function(){q=!0},function(){q=!1;setTimeout(function(){!r&&!b.attr("click")&&m()},20)})):"click"==a.event&&(a.aHide=!0,e.click(function(){b.attr("click","t");b.data("last_target")!==e?u.call(this):"none"==b.css("display")?u.call(this):m();b.data("last_target", e);d("html").unbind("click").click(function(a){"block"==b.css("display")&&!d(a.target).closest("#miniTip").length&&m()});return!1}));var u=function(){a.show&&a.show.call(this,a);if(a.content&&a.content!="")t=a.content;x.html(t);a.title!=""?v.html(a.title).show():v.hide();a.render&&a.render(b);w.removeAttr("class");b.hide().width("").width(b.width()).css("max-width",a.maxW);var j=e.is("area");if(j){var c,f=[],g=[],h=e.attr("coords").split(","),n=function(a,b){return a-b};for(c=0;c<h.length;c++){f.push(h[c++]); g.push(h[c])}c=e.parent().attr("name");c=d("img[usemap=\\#"+c+"]").offset();f=parseInt(c.left,10)+parseInt((parseInt(f.sort(n)[0],10)+parseInt(f.sort(n)[f.length-1],10))/2,10);g=parseInt(c.top,10)+parseInt((parseInt(g.sort(n)[0],10)+parseInt(g.sort(n)[g.length-1],10))/2,10)}else{g=parseInt(e.offset().top,10);f=parseInt(e.offset().left,10)}n=j?0:parseInt(e.outerWidth(),10);j=j?0:parseInt(e.outerHeight(),10);c=b.outerWidth();var h=b.outerHeight(),o=Math.round(f+Math.round((n-c)/2)),k=Math.round(g+j+ a.offset+8),l=Math.round(c-16)/2-parseInt(b.css("borderLeftWidth"),10),i=0,m=f+n+c+a.offset+8>parseInt(d(window).width(),10),q=c+a.offset+8>f,p=h+a.offset+8>g-d(window).scrollTop(),r=g+j+h+a.offset+8>parseInt(d(window).height()+d(window).scrollTop(),10),s=a.anchor;if(q||a.anchor=="e"&&!m){if(a.anchor=="w"||a.anchor=="e"){s="e";i=Math.round(h/2-8-parseInt(b.css("borderRightWidth"),10));l=-8-parseInt(b.css("borderRightWidth"),10);o=f+n+a.offset+8;k=Math.round(g+j/2-h/2)}}else if(m||a.anchor=="w"&&!q)if(a.anchor== "w"||a.anchor=="e"){s="w";i=Math.round(h/2-8-parseInt(b.css("borderLeftWidth"),10));l=c-parseInt(b.css("borderLeftWidth"),10);o=f-c-a.offset-8;k=Math.round(g+j/2-h/2)}if(r||a.anchor=="n"&&!p){if(a.anchor=="n"||a.anchor=="s"){s="n";i=h-parseInt(b.css("borderTopWidth"),10);k=g-(h+a.offset+8)}}else if(p||a.anchor=="s"&&!r)if(a.anchor=="n"||a.anchor=="s"){s="s";i=-8-parseInt(b.css("borderBottomWidth"),10);k=g+j+a.offset+8}if(a.anchor=="n"||a.anchor=="s")if(c/2>f){o=(o<0?l+o:l)-a.stemOff/2;l=0}else{if(f+ c/2>parseInt(d(window).width(),10)){o=o-l;l=l*2}}else if(p){k=k+i;i=0}else if(r){k=k-i;i=i*2}w.css({"margin-left":l+"px","margin-top":i+"px"}).attr("class",s);delay&&clearTimeout(delay);delay=setTimeout(function(){b.css({"margin-left":o+"px","margin-top":k+"px"}).stop(true,true).fadeIn(a.fadeIn)},a.delay)},m=function(){if(!a.aHide&&!q||a.aHide){delay&&clearTimeout(delay);delay=setTimeout(function(){p()},a.delay)}},p=function(){if(!a.aHide&&!q||a.aHide){b.stop(true,true).fadeOut(a.fadeOut);a.hide&& a.hide.call(this)}else setTimeout(function(){m()},200)}}})}})(jQuery);